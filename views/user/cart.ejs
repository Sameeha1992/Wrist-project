<%- include("../partials/user/profileHead") %>

<style>
  /* Cart Page Styles */
  .table td, .table th {
  text-align: center; /* Center-align all content */
  vertical-align: middle; /* Align content vertically */
  padding: 1rem;
}

.product-thumbnail img {
  display: block;
  margin: 0 auto; /* Center the image in its cell */
  max-width: 80px;
  height: auto;
}

.quantity-container {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 5px; /* Add spacing between buttons and input */
}

.quantity-container .btn {
  padding: 5px 10px; /* Adjust button size */
  font-size: 14px; /* Consistent font size */
  line-height: 1.5;
  border-radius: 3px;
}

.quantity-amount {
  width: 50px;
  text-align: center;
  font-size: 14px; /* Ensure readability */
}

.remove-btn {
  padding: 5px 10px;
  font-size: 12px;
  border-radius: 3px;
  background-color: #ff4d4d; /* Red color for remove button */
  color: white;
  border: none;
}

.remove-btn:hover {
  background-color: #e60000; /* Darker red on hover */
}

.cart-totals .row {
  margin-bottom: 1rem;
}

.cart-totals {
  background: #fff;
  padding: 20px;
  border-radius: 5px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.cart-totals .text-right {
  font-weight: bold;
  font-size: 1.2rem;
}

.btn-black {
  color: white;
  background-color: black;
  border: none;
  padding: 10px 15px;
  font-size: 16px;
  border-radius: 3px;
}

.btn-black:hover {
  background-color: #333;
}
</style>
  
<div class="untree_co-section before-footer-section">
  <div class="container">
    <div class="row mb-5">
      <form class="col-md-12" method="post">
        <div class="site-blocks-table">
          <table class="table">
            <thead>
              <tr>
                <th class="product-thumbnail">Image</th>
                <th class="product-name">Product</th>
                <th class="product-price">Price</th>
                <th class="product-quantity">Quantity</th>
                <th class="product-total">Total</th>
                <th class="product-remove">Remove</th>
              </tr>
            </thead>

            <tbody>
              <% if (cart && cart.length > 0) { %>
                <% cart.forEach((item) => { %>
                  <% if (item.error) { %>
                    <!-- Display message if product is unavailable -->
                    <tr>
                      <td colspan="6" class="text-danger text-center"><%= item.error %></td>
                    </tr>
                  <% } else { %>
                    <tr class="product-container" data-cart-item-id="<%= item.productId._id %>">
                      <!-- Product Image -->
                      <td class="product-thumbnail">
                        <a href="/product?id=<%= item.productId._id %>">
                          <img src="\uploads\re-image\<%= item.productId.productImage[0] %>" alt="<%= item.productId.productName %>" class="img-fluid" />
                        </a>
                      </td>
            
                      <!-- Product Details -->
                      <td class="product-name">
                        <h2 class="h5 text-black"><%= item.productId.productName %></h2>
                        <p class="text-muted"> <%= item.productId.brand %></p>
                        <p class="text-muted">Status: <%= item.productId.status %></p>
                      </td>
            
                    
                      
            
                      <!-- Quantity -->
                      <td>
                        <div class="quantity-container">
                          <button class="btn btn-outline-black decrease" type="button">&minus;</button>
                          <input type="text" class="form-control text-center quantity-amount" value="<%= item.quantity %>" readonly />
                          <button class="btn btn-outline-black increase" type="button">&plus;</button>
                        </div>
                        <% if (item.availableStock < item.quantity) { %>
                          <p class="text-danger">Only <%= item.availableStock %> available</p>
                        <% } %>
                      </td>
            
                      <!-- Total Price -->
                      <td>
                        $<%= (item.productId.salePrice * item.quantity).toFixed(2) %>
                      </td>
            
                      <!-- Remove Button -->
                      <td>
                        <a href="#" class="btn btn-black btn-sm remove-btn" id="<%= item.productId._id %>">X</a>
                      </td>
                    </tr>
                  <% } %>
                <% }) %>
              <% } else { %>
                <tr>
                  <td colspan="6" class="text-center">Your cart is empty</td>
                </tr>
              <% } %>
            </tbody>


           
          </table>
        </div>
      </form>
    </div>

    <div class="row">
      <div class="col-md-6">
        <div class="row mb-5">
          <div class="col-md-6">
            <a href="/products"><button class="btn btn-outline-black btn-sm btn-block" style="background-color: black; color: white;">Continue Shopping</button></a> 
          </div>
        </div>
      </div>
      <div class="col-md-6 pl-5">
        <div class="row justify-content-end">
          <div class="col-md-7">
            <div class="row">
              <div class="col-md-12 text-right border-bottom mb-5">
                <h3 class="text-black h4 text-uppercase">Cart Totals</h3>
              </div>
            </div>
            <div class="row mb-5">
              <div class="col-md-6">
                <span class="text-black">Total</span>
              </div>
              <div class="col-md-6 text-right">
                <strong class="text-black cartTotals" id="<%= cart.totalAmount %>"><%= cart.totalAmount %></strong>
              </div>
            </div>
            <div class="row">
              <div class="col-md-12">
                <button class="btn btn-black btn-lg py-3 btn-block" style="background-color: black; color: white;" onclick="window.location='/checkout'">Proceed To Checkout</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include("../partials/mainfooter") %>
